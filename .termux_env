#!/bin/bash

TERMUX_UTILS=$(realpath $(dirname ${BASH_SOURCE[0]}))


export USER_SCRIPTS=$HOME/.local/bin
export PATH=$USER_SCRIPTS:$PATH


# These will affect the loading of some things.
if [[ -f "$HOME/.termux_env_tweaks" ]];
then
    source "$HOME/.termux_env_tweaks"

    echo "Loaded tweaks for Termux environment."
    echo ""
fi


if [[ -v MINIMAL_TERMUX_ENV ]];
then
    echo "A minimal Termux environment will be loaded."
    echo ""
fi


if [[ -f "$PREFIX/bin/proot-distro" ]] && ! [[ -v MINIMAL_TERMUX_ENV ]];
then
    source "$TERMUX_UTILS/proots/.proots_env"
fi


if [[ -f "$PREFIX/bin/termux-x11" ]] && ! [[ -v DISABLE_X11 ]] && 
   ! [[ -v MINIMAL_TERMUX_ENV ]];
then
    source "$TERMUX_UTILS/x11/.x11_env"
fi


if [[ -f "$PREFIX/bin/pulseaudio" ]] && ! [[ -v DISABLE_AUDIO ]] &&
   ! [[ -v MINIMAL_TERMUX_ENV ]];
then
    source "$TERMUX_UTILS/x11/.audio_env"
fi


if [[ -f "$PREFIX/bin/fluidsynth" ]] && ! [[ -v DISABLE_MIDI ]] &&
   ! [[ -v MINIMAL_TERMUX_ENV ]];
then
    source "$TERMUX_UTILS/x11/midi_support/.midi_env"
fi


if [[ -f "$PREFIX/bin/virgl_test_server_android" ]] && ! [[ -v DISABLE_GL ]] &&
   ! [[ -v MINIMAL_TERMUX_ENV ]];
then
    source "$TERMUX_UTILS/x11/.3d_env"
fi


# Your own config
if [[ -f "$HOME/.user_env" ]] && ! [[ -v DISABLE_USER_ENV ]];
then
    source "$HOME/.user_env"

    echo "Loaded user environment."
    echo ""
fi


echo "Finished loading Termux environment."
echo ""
