if ! [[ -v SOUNDFONT ]];
then
    echo "A preferred SOUNDFONT wasn't set. Finding available ones ..."
    echo ""
    
    if ! [[ "$TERMUX_VERSION" == "" ]];
    then
        SOUNDFONT="$SCRIPT_HOME/GeneralUser-GS.sf2"
    else
        SOUNDFONTS=$(find /usr/share/* -type f -name "*.sf2")

        if ! [[ "$SOUNDFONTS" == "" ]];
        then
            SOUNDFONT=$(echo "$SOUNDFONTS" | grep -m 1 .sf2)
        fi
    fi
fi


if ! [[ -f "$SOUNDFONT" ]];
then
    echo "Cannot find the desired soundfont '$SOUNDFONT'."
    echo ""
else
    export FLUIDSYNTH_OPTS="-a alsa -m alsa_seq -l "
    export FLUIDSYNTH_OPTS+="-s \"$SOUNDFONT\""
fi


if [[ -v FLUIDSYNTH_OPTS ]];
then
    echo "MIDI environment loaded."
    echo "Using '$SOUNDFONT' soundfont."
    echo ""
    echo "You can now enable MIDI support for use with X11 apps."
    echo ""
fi

